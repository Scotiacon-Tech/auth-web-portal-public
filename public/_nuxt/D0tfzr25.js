import{_ as we}from"./CyirxTcg.js";import{H as j,r as h,U as ie,V as de,W as ye,o as m,J as C,w as a,b as t,d as V,t as S,L as T,N as p,X as H,M as ce,c as F,F as Z,a as O,u as x,_ as W,p as be,Y as ke,m as he,n as Le,Z as _e,q as D,$ as Ce,g as Q,x as Re,y as ae,a0 as ne,C as Te,a1 as Ie,R as K,v as $e,Q as le,T as X,S as me}from"./DvixYH9T.js";import{s as A,u as Ae}from"./DdjfN0l3.js";import{V as R,a as I}from"./Bj0IWiKA.js";import{d as oe,e as fe,g as Be,a as Ne,u as Ve,b as Oe}from"./D1bjLZ8C.js";import{V as P,b as Se,c as Ee}from"./HyvrZmyD.js";import{j as Ue,a as se}from"./DuaSZ-y1.js";import{m as qe,a as Fe,u as De}from"./DHrUxnTR.js";import{u as ve,V as Me,a as Pe}from"./Cp-I4hqV.js";import{V as xe}from"./Bwjt_S9n.js";/* empty css        */import"./5dxMDfVn.js";import"./AbBJySgT.js";import"./Ct6Uo_IL.js";var M=(e=>(e.ADD_CREDENTIAL="ADD_CREDENTIAL",e.COMBINED="COMBINED",e.LOGIN="LOGIN",e.REGISTER="REGISTER",e))(M||{});const je={key:1,class:"ma-auto text-left"},Ge={key:2,class:"ma-auto text-left"},ze={key:3,class:"ma-auto text-left"},Je={class:"text-red-darken-1 font-weight-bold"},Ke={class:"text-center mt-4"},Ze=j({__name:"EmailLoginForm",props:{disabled:{type:Boolean,default:!1},variant:{default:()=>M.COMBINED}},emits:["callback"],setup(e,{emit:r}){const l=h(!0);ie();const y=x(),o=r,{smAndUp:u}=de(),_=h(!1),g=h(!1),L=h(!1),n=h(""),v=h(""),s=h(!1),i=h({required:c=>!!c||"Required.",min:c=>c.length>=8||"Min 8 characters",email:c=>!!c.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)||"Valid email address required"}),d=h(""),$=()=>(d.value="",!(i.value.required(n.value)!==!0||i.value.email(n.value)!==!0||i.value.required(v.value)!==!0||i.value.min(v.value)!==!0)),f=c=>{c.preventDefault(),$()&&o("callback",{mode:"login",username:n.value,password:v.value})},k=c=>{c.preventDefault(),(d.value="",!(i.value.required(n.value)!==!0||i.value.email(n.value)!==!0||i.value.required(v.value)!==!0||i.value.min(v.value)!==!0))&&o("callback",{mode:"create",username:n.value,password:v.value})},G=c=>{c.preventDefault(),(d.value="",!(i.value.required(n.value)!==!0||i.value.email(n.value)!==!0))&&o("callback",{mode:"link",username:n.value,password:v.value})};return(c,b)=>{const Y=ye("router-link");return l.value?(m(),C(fe,{key:0,onSubmit:ce(f,["stop"]),disabled:c.disabled,id:"login-form",action:`/${p(y).public.issuerUri}/connect/auth/internal`,method:"post"},{default:a(()=>[t(I,null,{default:a(()=>[t(R,null,{default:a(()=>[t(oe,{margin:"normal",required:"",id:"username",label:"Email Address",name:"username",autocomplete:"username",autofocus:"",variant:"outlined",modelValue:n.value,"onUpdate:modelValue":b[0]||(b[0]=z=>n.value=z),rules:[i.value.required,i.value.email],clearable:!0},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(I,null,{default:a(()=>[t(R,null,{default:a(()=>[t(oe,{margin:"normal",required:"",name:"password",label:"Password",type:s.value?"text":"password",id:"password",autocomplete:"current-password",variant:"outlined",modelValue:v.value,"onUpdate:modelValue":b[1]||(b[1]=z=>v.value=z),"append-inner-icon":s.value?"mdi:mdi-eye-off":"mdi:mdi-eye","onClick:appendInner":b[2]||(b[2]=z=>s.value=!s.value),counter:"",hint:"At least 8 characters",rules:[i.value.required,i.value.min],clearable:!1},null,8,["type","modelValue","append-inner-icon","rules"])]),_:1})]),_:1}),d.value?(m(),C(I,{key:0},{default:a(()=>[t(R,{class:"text-red-darken-1 font-weight-bold"},{default:a(()=>[V(S(d.value),1)]),_:1})]),_:1})):T("",!0),t(I,{justify:"space-between"},{default:a(()=>[c.variant===p(M).COMBINED||c.variant===p(M).REGISTER?(m(),C(R,{key:0,cols:"12",sm:"7",order:"2","order-sm":"1",class:H(`${p(u)?"":"text-center"}`)},{default:a(()=>[t(P,{color:"orange-darken-2",disabled:c.disabled,class:"w-100","prepend-icon":"mdi:mdi-account-edit",onClick:k},{default:a(()=>b[3]||(b[3]=[V(" Create Account ")])),_:1},8,["disabled"])]),_:1},8,["class"])):T("",!0),c.variant===p(M).COMBINED||c.variant===p(M).LOGIN?(m(),C(R,{key:1,cols:"12",sm:"5",order:"1","order-sm":"2",class:H(`${p(u)?"text-right":"text-center"}`)},{default:a(()=>[t(P,{color:"success",disabled:c.disabled,type:"submit",class:"w-100","prepend-icon":"mdi:mdi-login"},{default:a(()=>b[4]||(b[4]=[V(" Sign In ")])),_:1},8,["disabled"])]),_:1},8,["class"])):T("",!0),c.variant===p(M).ADD_CREDENTIAL?(m(),C(R,{key:2,cols:"12",sm:"6",class:"flex-grow-0"},{default:a(()=>[t(P,{color:"orange-darken-2",disabled:c.disabled},{default:a(()=>b[5]||(b[5]=[V(" Add Email ")])),_:1},8,["disabled"])]),_:1})):T("",!0)]),_:1}),c.variant===p(M).COMBINED||c.variant===p(M).LOGIN?(m(),C(I,{key:1},{default:a(()=>[t(R,null,{default:a(()=>[t(P,{onClick:G,class:"w-100",color:"grey",disabled:c.disabled,"prepend-icon":"mdi:mdi-account-question"},{default:a(()=>[V(S(p(A).buttonForgottenPassword),1)]),_:1},8,["disabled"])]),_:1})]),_:1})):T("",!0)]),_:1},8,["disabled","action"])):_.value?(m(),F("p",je,S(p(A).messageResetEmail),1)):g.value?(m(),F("p",Ge,S(p(A).messageVerifyNewAccountEmail),1)):L.value?(m(),F("p",ze,[V(S(p(A).messageVerifiedNewAccountMessage)+" ",1),d.value?(m(),F(Z,{key:0},[b[9]||(b[9]=O("br",null,null,-1)),b[10]||(b[10]=O("br",null,null,-1)),O("span",Je,[b[6]||(b[6]=V(" An error occurred creating or recovering account:")),b[7]||(b[7]=O("br",null,null,-1)),V(" "+S(d.value),1)]),b[11]||(b[11]=O("br",null,null,-1)),b[12]||(b[12]=O("br",null,null,-1)),b[13]||(b[13]=O("span",{class:"text-red-darken-4"}," Please contact registration if you require further assistance. ",-1)),O("div",Ke,[t(Y,{to:"/"},{default:a(()=>[t(P,{color:"red"},{default:a(()=>b[8]||(b[8]=[V("Close")])),_:1})]),_:1})])],64)):T("",!0)])):T("",!0)}}}),We=W(Ze,[["__scopeId","data-v-928490fa"]]),Ye=be({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...qe(),...Be(),...ke(Ne({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),He=he()({name:"VOtpInput",props:Ye(),emits:{finish:e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,r){let{attrs:l,emit:y,slots:o}=r;const{dimensionStyles:u}=Fe(e),{isFocused:_,focus:g,blur:L}=Ve(e),n=Le(e,"modelValue","",w=>w==null?[]:String(w).split(""),w=>w.join("")),{t:v}=_e(),s=D(()=>Number(e.length)),i=D(()=>Array(s.value).fill(0)),d=h(-1),$=h(),f=h([]),k=D(()=>f.value[d.value]);function G(){if(te(k.value.value)){k.value.value="";return}const w=n.value.slice(),B=k.value.value;w[d.value]=B;let E=null;d.value>n.value.length?E=n.value.length+1:d.value+1!==s.value&&(E="next"),n.value=w,E&&ne($.value,E)}function c(w){const B=n.value.slice(),E=d.value;let U=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(w.key)&&(w.preventDefault(),w.key==="ArrowLeft"?U="prev":w.key==="ArrowRight"?U="next":["Backspace","Delete"].includes(w.key)&&(B[d.value]="",n.value=B,d.value>0&&w.key==="Backspace"?U="prev":requestAnimationFrame(()=>{var N;(N=f.value[E])==null||N.select()})),requestAnimationFrame(()=>{U!=null&&ne($.value,U)}))}function b(w,B){var U,N;B.preventDefault(),B.stopPropagation();const E=((U=B==null?void 0:B.clipboardData)==null?void 0:U.getData("Text").slice(0,s.value))??"";te(E)||(n.value=E.split(""),(N=f.value)==null||N[w].blur())}function Y(){n.value=[]}function z(w,B){g(),d.value=B}function ge(){L(),d.value=-1}function te(w){return e.type==="number"&&/[^0-9]/g.test(w)}return Ce({VField:{color:D(()=>e.color),bgColor:D(()=>e.color),baseColor:D(()=>e.baseColor),disabled:D(()=>e.disabled),error:D(()=>e.error),variant:D(()=>e.variant)}},{scoped:!0}),Q(n,w=>{w.length===s.value&&y("finish",w.join(""))},{deep:!0}),Q(d,w=>{w<0||Te(()=>{var B;(B=f.value[w])==null||B.select()})}),De(()=>{var E;const[w,B]=Re(l);return t("div",ae({class:["v-otp-input",{"v-otp-input--divided":!!e.divider},e.class],style:[e.style]},w),[t("div",{ref:$,class:"v-otp-input__content",style:[u.value]},[i.value.map((U,N)=>t(Z,null,[e.divider&&N!==0&&t("span",{class:"v-otp-input__divider"},[e.divider]),t(Oe,{focused:_.value&&e.focusAll||d.value===N,key:N},{...o,loader:void 0,default:()=>t("input",{ref:J=>f.value[N]=J,"aria-label":v(e.label,N+1),autofocus:N===0&&e.autofocus,autocomplete:"one-time-code",class:["v-otp-input__field"],disabled:e.disabled,inputmode:e.type==="number"?"numeric":"text",min:e.type==="number"?0:void 0,maxlength:"1",placeholder:e.placeholder,type:e.type==="number"?"text":e.type,value:n.value[N],onInput:G,onFocus:J=>z(J,N),onBlur:ge,onKeydown:c,onPaste:J=>b(N,J)},null)})])),t("input",ae({class:"v-otp-input-input",type:"hidden"},B,{value:n.value.join("")}),null),t(Ue,{contained:!0,"content-class":"v-otp-input__loader","model-value":!!e.loading,persistent:!0},{default:()=>{var U;return[((U=o.loader)==null?void 0:U.call(o))??t(Se,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(E=o.default)==null?void 0:E.call(o)])])}),{blur:()=>{var w;(w=f.value)==null||w.some(B=>B.blur())},focus:()=>{var w;(w=f.value)==null||w[0].focus()},reset:Y,isFocused:_}}}),Qe=j({__name:"OTPLoginForm",props:{email:{},disabled:{type:Boolean,default:!1}},emits:["callback"],setup(e,{emit:r}){h(!0),ie();const l=r;de();const y=h(""),o=h({required:g=>!!g||"Required.",min:g=>g.length>=6||"Min 6 characters"}),u=h(""),_=g=>{g.preventDefault(),(u.value="",!(o.value.required(y.value)!==!0||o.value.min(y.value)!==!0))&&(console.log("emit baby"),l("callback",{mode:"validate",username:e.email,password:y.value}))};return(g,L)=>(m(),C(fe,{onSubmit:L[1]||(L[1]=ce(()=>{},["stop"])),disabled:g.disabled},{default:a(()=>[L[3]||(L[3]=O("h3",{class:"text-h6 mb-2"}," Please enter the one time password to verify your account ",-1)),O("p",null,"A code has been sent to "+S(g.email),1),t(I,null,{default:a(()=>[t(R,null,{default:a(()=>[t(He,{disabled:g.disabled,length:"6",modelValue:y.value,"onUpdate:modelValue":L[0]||(L[0]=n=>y.value=n),rules:[o.value.required,o.value.min]},null,8,["disabled","modelValue","rules"])]),_:1})]),_:1}),t(I,null,{default:a(()=>[t(R,null,{default:a(()=>[t(P,{disabled:y.value.length!=6,type:"submit",onClick:_,color:"primary",variant:"flat",class:"w-100"},{default:a(()=>L[2]||(L[2]=[V(" Validate ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"]))}}),Xe=W(Qe,[["__scopeId","data-v-c50d85ca"]]),ee=()=>{const e=Ie(),r=JSON.stringify(e.query),l=new Ee;return l.parseJSON(r),l},et=async(e,r,l=!1)=>{const y=x();return await $fetch(`${y.public.issuerUri}/connect/auth/internal`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:r.username,password:r.password},new:l}),parseResponse:o=>{const u=JSON.parse(o);if(u.RedirectURI)return u.RedirectURI;throw o}})},re=async(e,r,l="",y=!1)=>{const o=x();return await $fetch(`${o.public.issuerUri}/connect/email/link`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:r,password:l},new:y})})},tt=async(e,r,l=!1)=>{const y=x();return await $fetch(`${y.public.issuerUri}/connect/auth/otp`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:r.username,password:r.password},new:l}),parseResponse:o=>{const u=JSON.parse(o);if(u.RedirectURI)return u.RedirectURI;throw o}})},at={class:"ma-auto",style:{"max-width":"450px"}},nt=j({__name:"email",props:{variant:{default:()=>M.COMBINED}},emits:["cancel"],setup(e,{emit:r}){const l=r,y=ve(),o=h(""),u=h("email"),_=h(!1),g=ee(),L=h(!1),n=h(),v=f=>{switch(f.mode.toLocaleString()){case"create":return s(f);case"link":return i(f.username);case"login":return $(f);case"register":return;case"validate":return d(f)}},s=async f=>{L.value=!1;const{token:k}=await re(g,f.username,f.password,!0);o.value=f.username,n.value=k,u.value="otp_create"},i=async f=>{L.value=!1;const{token:k}=await re(g,f);o.value=f,n.value=k,u.value="otp_validate"},d=async f=>{_.value=!0;const k=await tt(g,{username:f.username,password:`${n.value}:${f.password}`},u.value=="otp_create");if(k){const c=new URL(k).searchParams.get("error");if((c==null?void 0:c.toLowerCase())!="invalid_request"&&(c==null?void 0:c.toLowerCase())!="access_denied"){K(k,{external:!0});return}}L.value=!0,_.value=!1,u.value="email"},$=async f=>{_.value=!0,L.value=!1;const k=await et(g,f);if(k){const c=new URL(k).searchParams.get("error");if((c==null?void 0:c.toLowerCase())=="invalid_request"){L.value=!0,_.value=!1;return}K(k,{external:!0})}};return(f,k)=>(m(),F("div",at,[p(L)?(m(),C(I,{key:0},{default:a(()=>[t(R,null,{default:a(()=>[t(Me,{type:"error"},{default:a(()=>[t(Pe,null,{default:a(()=>k[1]||(k[1]=[V("Login Failed")])),_:1}),k[2]||(k[2]=V(" There was problem with your login attempt. It may be the account doesn't exist or your password was incorrect. You may have also created your account using a Telegram login instead. "))]),_:1})]),_:1})]),_:1})):T("",!0),t(I,null,{default:a(()=>[t(R,null,{default:a(()=>[p(u)=="email"?(m(),C(We,{key:0,disabled:p(_),"redirect-url":p(y).href,variant:f.variant,onCallback:v},null,8,["disabled","redirect-url","variant"])):p(u)=="otp_create"||p(u)=="otp_validate"?(m(),C(Xe,{key:1,disabled:p(_),email:p(o),onCallback:v},null,8,["disabled","email"])):T("",!0)]),_:1})]),_:1}),t(I,null,{default:a(()=>[t(R,{class:"text-left"},{default:a(()=>[t(P,{color:"error",onClick:k[0]||(k[0]=G=>l("cancel")),class:"w-100","prepend-icon":"mdi:mdi-arrow-left-circle"},{default:a(()=>k[3]||(k[3]=[V(" Go Back ")])),_:1})]),_:1})]),_:1})]))}}),lt={key:0,class:"ml-1"},ot=j({__name:"AuthButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},class:{default:""},credential:{},showUsername:{type:Boolean,default:!1},source:{default:"internal"}},setup(e){const r={amazon:{icon:"fa:fas fa-brands fa-amazon",label:A.buttonLoginAmazon,name:"Amazon"},email:{icon:"mdi:mdi-email",label:A.buttonLoginEmail,name:"Email"},facebook:{icon:"fa:fa fa-brands fa-facebook",label:A.buttonLoginFaceBook,name:"FaceBook"},google:{icon:"fa:fa fa-brands fa-google",label:A.buttonLoginGoogle,name:"Google"},internal:{icon:"mdi:mdi-email",label:A.buttonLoginEmail,name:"Email"},instagram:{icon:"fa:fa fa-brands fa-instagram",label:A.buttonLoginInstagram,name:"Instagram"},keycloak:{icon:"mdi:mdi-key-variant",label:A.buttonLoginKeycloak,name:"Keycloak"},microsoft:{icon:"fa:fa fa-brands fa-windows",label:A.buttonLoginMicrosoft,name:"Microsoft"},steam:{icon:"fa:fa fa-brands fa-steam",label:A.buttonLoginSteam,name:"Steam"},telegram:{icon:"fa:fa fa-brands fa-telegram",label:A.buttonLoginTelegram,name:"Telegram"},twitch:{icon:"fa:fa fa-brands fa-twitch",label:A.buttonLoginTwitch,name:"Twitch"},twitter:{icon:"fa:fa fa-brands fa-twitter",label:A.buttonLoginTwitter,name:"Twitter"}},l=h(r[e.source.toLowerCase()].label||""),y=h(r[e.source.toLowerCase()].icon||""),o=D(()=>{var u,_;if(e.source.toLowerCase()==="internal"||e.source.toLowerCase()==="email")return(u=e.credential)==null?void 0:u.Email;try{const g=JSON.parse(((_=e.credential)==null?void 0:_.Data)||"{}");switch(e.source.toLowerCase()){case"telegram":return`@${g.username||g.id}`}}catch{}return""});return(u,_)=>(m(),C(P,{"append-icon":u.appendIcon,"prepend-icon":y.value,class:H(`${u.source.toLowerCase()} ${e.class}`)},{default:a(()=>[V(S(l.value)+" ",1),u.showUsername&&u.credential?(m(),F("small",lt,"("+S(o.value)+")",1)):T("",!0)]),_:1},8,["append-icon","prepend-icon","class"]))}}),pe=W(ot,[["__scopeId","data-v-169c8e1b"]]),ue=async(e,r,l=!1)=>{const y=x();return await $fetch(`${y.public.issuerUri}/connect/auth/telegram`,{method:"post",body:JSON.stringify({oauth:e,telegram:r,new:l}),parseResponse:o=>{const u=JSON.parse(o);if(u.RedirectURI)return u.RedirectURI;throw o}})},st={key:0,class:"my-2"},rt={key:1,class:"my-2"},ut={class:"my-2"},it={class:"my-2"},dt={class:"my-2"},ct=j({__name:"TelegramButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},class:{default:""},credential:{},showUsername:{type:Boolean,default:!1}},emits:["cancel"],setup(e,{emit:r}){const l=r,y=x();ve();const o=ee(),u=h(!1),_=h(!1),g=h(0),L=h();h();const n=h(),v=async()=>{if(u.value=!1,!L.value)return;const d=await ue(o,L.value,!0);d&&K(d,{external:!0})},s=()=>{{if(!window.Telegram||!window.Telegram.Login||!window.Telegram.Login.auth){console.error("Telegram not initialised");return}window.Telegram.Login.auth({bot_id:y.public.telegramBotId||"",request_access:!0},d=>{d||console.error("Telegram Authorization Failed"),i(d)})}},i=async d=>{const $=await ue(o,d,!1);if($){const k=new URL($).searchParams.get("error");k?k=="access_denied"?(u.value=!0,L.value=d):k=="invalid_request"?(_.value=!0,g.value=1):k=="server_error"&&(_.value=!0,g.value=2):K($,{external:!0})}};return $e(()=>{const d=document.createElement("script");d.async=!0,d.src="https://telegram.org/js/telegram-widget.js?22",n.value.appendChild(d)}),(d,$)=>(m(),F(Z,null,[t(I,null,{default:a(()=>[t(R,{class:"text-center"},{default:a(()=>[O("div",{ref_key:"telegram",ref:n},null,512),t(pe,{"append-icon":d.appendIcon,credential:d.credential,"show-username":d.showUsername,source:"telegram",class:"d-flex justify-start w-100",onClick:s},null,8,["append-icon","credential","show-username"])]),_:1})]),_:1}),t(se,{modelValue:p(_),"onUpdate:modelValue":$[0]||($[0]=f=>le(_)?_.value=f:null),"show-save-action":!1,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Error Attempting Telegram Login","hide-extension":!0,"remove-button-spacer":!0,"close-action-label":"Close",onClose:$[1]||($[1]=f=>_.value=!1)},{default:a(()=>[p(g)===1?(m(),F("p",st,S(p(A).messageCreateTelegramError1),1)):T("",!0),p(g)===2?(m(),F("p",rt,S(p(A).messageCreateTelegramError2),1)):T("",!0)]),_:1},8,["modelValue"]),t(se,{modelValue:p(u),"onUpdate:modelValue":$[2]||($[2]=f=>le(u)?u.value=f:null),"show-save-action":!0,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Create new account","hide-extension":!0,"save-button-label":"Create Account",onSave:v,onClose:$[3]||($[3]=f=>l("cancel"))},{default:a(()=>[O("p",ut,S(p(A).messageCreateTelegramAccount1),1),O("p",it,S(p(A).messageCreateTelegramAccount2),1),O("p",dt,S(p(A).messageCreateTelegramAccount3),1)]),_:1},8,["modelValue"])],64))}}),mt=j({__name:"LoginButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},credential:{},params:{},showUsername:{type:Boolean,default:!1},source:{default:"internal"}},setup(e){return(r,l)=>r.source=="telegram"?(m(),C(ct,{key:0})):(m(),C(pe,{key:1,"append-icon":r.appendIcon,credential:r.credential,"show-username":r.showUsername,source:r.source,class:"d-flex justify-start w-100"},null,8,["append-icon","credential","show-username","source"]))}}),q=W(mt,[["__scopeId","data-v-9a086b0f"]]),ft=async e=>{const r=x();try{const l=await $fetch(`${r.public.issuerUri}/connect/auth/urls?baseRedirect=${e}`,{method:"get",parseResponse:o=>o}),y=JSON.parse(l);return new Map(Object.entries(y.URLs))}catch(l){throw l}},vt=j({__name:"LoginButtons",props:{showAmazonLogin:{type:Boolean,default:!1},showEmailLogin:{type:Boolean,default:!1},showFaceBookLogin:{type:Boolean,default:!1},showGoogleLogin:{type:Boolean,default:!1},showInstagramLogin:{type:Boolean,default:!1},showKeycloakLogin:{type:Boolean,default:!1},showMicrosoftLogin:{type:Boolean,default:!1},showSteamLogin:{type:Boolean,default:!1},showTelegramLogin:{type:Boolean,default:!1},showTwitchLogin:{type:Boolean,default:!1},showTwitterLogin:{type:Boolean,default:!1}},emits:["login"],async setup(e,{emit:r}){let l,y;const{addState:o}=Ae(),u=ee(),_=X(),g=([l,y]=me(()=>ft(`${window.location.origin}${_.resolve("/connect/external").href}`)),l=await l,y(),l),L=r,n=h("");return Q(n,()=>{const v=g.get(n.value);if(!v){L("login",{method:n.value});return}const i=new URL(v).searchParams.get("state");i&&o(i,u),L("login",{method:n.value,uri:v})}),(v,s)=>(m(),F("div",null,[v.showEmailLogin?(m(),C(I,{key:0,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"internal",onClick:s[0]||(s[0]=i=>n.value="internal")})]),_:1})]),_:1})):T("",!0),v.showAmazonLogin?(m(),C(I,{key:1,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"amazon",onClick:s[1]||(s[1]=i=>n.value="amazon")})]),_:1})]),_:1})):T("",!0),v.showFaceBookLogin?(m(),C(I,{key:2,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"facebook",onClick:s[2]||(s[2]=i=>n.value="facebook")})]),_:1})]),_:1})):T("",!0),v.showGoogleLogin?(m(),C(I,{key:3,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"google",onClick:s[3]||(s[3]=i=>n.value="google")})]),_:1})]),_:1})):T("",!0),v.showInstagramLogin?(m(),C(I,{key:4,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"instagram",onClick:s[4]||(s[4]=i=>n.value="instagram")})]),_:1})]),_:1})):T("",!0),v.showMicrosoftLogin?(m(),C(I,{key:5,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"microsoft",onClick:s[5]||(s[5]=i=>n.value="microsoft")})]),_:1})]),_:1})):T("",!0),v.showSteamLogin?(m(),C(I,{key:6,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"steam",onClick:s[6]||(s[6]=i=>n.value="steam")})]),_:1})]),_:1})):T("",!0),v.showTelegramLogin?(m(),C(I,{key:7,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"telegram"})]),_:1})]),_:1})):T("",!0),v.showTwitchLogin?(m(),C(I,{key:8,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"twitch",onClick:s[7]||(s[7]=i=>n.value="twitch")})]),_:1})]),_:1})):T("",!0),v.showTwitterLogin?(m(),C(I,{key:9,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"twitter",onClick:s[8]||(s[8]=i=>n.value="twitter")})]),_:1})]),_:1})):T("",!0),v.showKeycloakLogin?(m(),C(I,{key:10,dense:!0},{default:a(()=>[t(R,null,{default:a(()=>[t(q,{source:"keycloak",onClick:s[9]||(s[9]=i=>n.value="keycloak")})]),_:1})]),_:1})):T("",!0)]))}}),pt=()=>{try{const e=X(),r=e.currentRoute.value.query.state||"",l=new URL(e.currentRoute.value.query.redirect_uri||"");return l.searchParams.set("state",r),l.toString()}catch(e){console.error(e)}return""},gt=async e=>{const r=x();try{return await $fetch(`${r.public.issuerUri}/connect/style/${e}`,{method:"get",parseResponse:l=>{try{return JSON.parse(l)}catch{throw l}}})}catch{return{}}},wt={class:"text-center"},Vt=j({__name:"index",emits:["pageTitle"],async setup(e,{emit:r}){let l,y;const o=x();r("pageTitle","Login");const _=pt(),g=h("BUTTONS"),L=({method:s,uri:i})=>{switch(s){case"internal":g.value="INTERNAL_LOGIN";break;case"keycloak":K(i,{external:!0});break}},n=X(),v=([l,y]=me(()=>gt(n.currentRoute.value.query.client_id)),l=await l,y(),l);if(v){const s=document.createElement("style");s.textContent=v.css,document.head.append(s)}return(s,i)=>{const d=we;return m(),C(xe,null,{default:a(()=>[O("h1",wt,S(p(o).public.organisationName),1),p(g)=="BUTTONS"?(m(),F(Z,{key:0},[t(vt,{showEmailLogin:!0,showKeycloakLogin:!0,showTelegramLogin:!0,onLogin:L,style:{"max-width":"250px"},class:"ma-auto mb-5"}),t(I,null,{default:a(()=>[t(R,{class:"pa-0 text-center"},{default:a(()=>[t(d,{href:p(_)},{default:a(()=>[t(P,{variant:"text"},{default:a(()=>i[1]||(i[1]=[V(" Cancel ")])),_:1})]),_:1},8,["href"])]),_:1})]),_:1})],64)):p(g)=="INTERNAL_LOGIN"?(m(),C(nt,{key:1,onCancel:i[0]||(i[0]=$=>g.value="BUTTONS")})):T("",!0)]),_:1})}}});export{Vt as default};
